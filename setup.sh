#! /bin/bash
set -e

sudo add-apt-repository ppa:x2go/stable
sudo apt-get update
sudo apt-get -y install x2goserver x2goserver-xsession xfce4 firefox

# We want to skip any initial Xfce configuration, this puts the default one in the right place.
XFCE_CONFIG_DIR_TARBZ="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"

cd /home/ubuntu
rm -rf .config # safe at this point
echo $XFCE_CONFIG_DIR_TARBZ | base64 -d | tar xjf -

